from typing import Set


class Vulnerability:
    def __init__(self, name: str, sources: Set[str], sanitizers: Set[str], sink: str):
        self.vulnerability = {
            "vulnerability": name,
            "sources": list(sources),
            "sanitizers": list(sanitizers),
            "sinks": [sink]
        }

    def getObject(self) -> dict:
        return self.vulnerability

    def __str__(self) -> str:
        return str(self.vulnerability)

    def __eq__(self, other):
        return isinstance(other, Vulnerability) and \
               self.vulnerability["vulnerability"] == other.vulnerability["vulnerability"] and \
               self.vulnerability["sources"] == other.vulnerability["sources"] and \
               self.vulnerability["sanitizers"] == other.vulnerability["sanitizers"] and \
               self.vulnerability["sinks"] == other.vulnerability["sinks"]

    def __hash__(self):
        return hash(str(self.vulnerability))
